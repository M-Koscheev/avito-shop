# avito-shop
Test  project for avito internship 2025


----
С моей точки зрения у ручки  api/auth не должно быть ситуаций при которых, она должна вернуть статус 401 неавторизирован.
Любой пользователь должен иметь возможность регистрации на сервере - если нет, то исходя из данных запроса никак нельзя понять кому давать доступ к ручке.

Понимаю, что в теории это внутренний сервис, но в данной симуляции ситуации 401 вернуться не может.

-----

Добавил валидацию количества передаваемых монет через структурные теги (validate)

---- 

Добавил валидацию доступных для покупки предметов в сваггер и 


------

Что касается БД - принял решение нормализировать БД - вынеся товары в отдельную таблицу, и храня цену только в ней.
При таком подходе мы не сможем менять цену товаров, не сломав цену купленных товаром, но этого и нет в условии.

Т.к. товары приобретаются поштучно, то не имеет смысла хранить в БД данные о количестве купленных за транзакцию предметов, а также видах этих предметов.

Т.к. у сотрудника нет избавляться от мерча, то не имеет смысла создавать отдельную талицу, хранящую мерч сотрудника - данные можно брать напрямую из таблицы

Создал енумератор названий товаров - ыо избежание случайных вставок и инъекций.

Для повышения отказоустойчивости а также для обеспечения доступа из разных регионов (например, при наличии офисов в нескольких странах) рекомендую в дальнейшем реплицировать БД, а также шардировать при большой нагрузке на сервера.
------

для ускорения поиска по таблице пользователей создал индекс по имени пользователя.

создал индексы для пользователей которые передают и которым передают монеты - это ускорит запросы н получение информации о получении монет

создал индекс для айди сотрудника по таблице купленных товаров - ускорит запросы на чтение списка купленных сотрудником товаров



-------

аутентификация

принял решение хранить айди пользователя в JWT токене
.....

Пароль будет храниться в хэшированном виде в БД - в таком случае в случае возможной утечки дынных злоумышленники не получат доступ к паролям пользователей.
В качестве алгоритма хэширования выбрал SHA256.

токен действует 12 часов, после чего потребуется пройти аутентификацию заново
----

веб

в качестве веб фреймворка выбрал gin
-------

ошибки и сложности

- при генерации документации сваггером получал следующую ошибку:
- failed to get package name in dir: ./, ...... failed to evaluate const mProfCycleWrap at ......
- После поиска информации об ошибке пришел к выводу, что это, вероятно, проблема совместимости версии go и swaggo/swag, котороую можно игнорировать


-----------------------

распараллелил проверку пользователей на существование